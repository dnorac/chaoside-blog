---
title: "As desvantagens da arquitetura de microsserviços"
originalUrl: "https://pt.linkedin.com/pulse/desvantagens-da-arquitetura-de-microsservi%C3%A7os-daniel-castro"
---

Em maio de 2021 completarão dez anos desde que o termo _microsserviços_ foi cunhado em um workshop de arquitetura de software em Veneza. Após o pioneirismo de companhias como Netflix e Amazon, esse estilo estrutural de serviços tornou-se cada vez mais popular, e ainda hoje é muito explorado. Analisando esse período de existência, podemos perceber as vantagens e desvantagens de trabalharmos com microsserviços, o que é importante conhecer para tomar decisões mais acertadas e minimizar custos de projeto e desenvolvimento.

Microsserviços podem ser entendidos como um desenvolvimento natural do estilo de _arquitetura orientada a serviços_ (SOA) em uma era de sistemas de software distribuídos. Os fundamentos e conceitos que subjazem o termo, porém, o precedem por anos. Já em 2005, o Dr. Peter Rogers utilizava o nome _Micro-Web-Services_ no esforço de comunicar as noções por trás desse estilo de projeto de software.

Assim como a SOA, microsserviços são caracterizados pela separação do software em unidades funcionais discretas (serviços) que se comunicam entre si através de uma rede por meio de um protocolo de comunicação utilizando um formato de dados compartilhado e bem definido, o que permite maior modularização e menor acoplamento entre serviços.

Enquanto na SOA os protocolos e formatos de dados são robustos e frequentemente mais complexos, com modelos de comunicação síncrona (o que torna a comunicação dependente da ordem e latência das mensagens trocadas entre os serviços), nos microsserviços eles são mais simples, geralmente assíncronos e autocontidos, i.e., cada serviço costuma ser responsável por manter os dados e informações que ele precisa utilizar, e costuma implementar um modelo de event sourcing (publish/subscribe) para que mudanças em um componente notifiquem outros componentes interessados na informação.

Mas apesar do entusiasmo com que recebemos essa arquitetura (afinal, quem não quer uma arquitetura bem organizada e separada?), a separação de serviços, seja na SOA ou em microsserviços, introduz questões complexas que ainda precisam ser melhor endereçadas e que, se ignoradas, podem custar caro quando comparadas com a arquitetura monolítica.

Em primeiro lugar, a separação da aplicação em serviços que operam em diferentes contêineres implica um certo desperdício de recursos computacionais, desde processamento, memória e armazenamento. Se em uma aplicação monolítica as diferentes partes que a compõem compartilham os recursos do sistema hospedeiro, na conteinerização cada serviço repetirá desnecessariamente arquivos, bibliotecas e processos, já que cada contêiner replica uma imagem básica de um sistema operacional.

Depois, como todos os serviços se comunicam através de uma rede, a comunicação está sujeita a diversos tipos de falha (conexão não estabelecida, fila de requisições, atrasos, etc) que precisam ser contornadas com mecanismos como message queues (Amazon SQS, Kafka, RabbitMQ, etc), que garantam a entrega da mensagem na eventual indisponibilidade do meio de comunicação. Isso é especialmente importante para eventos críticos, como o processamento ou cancelamento de pagamentos. A conteinerização desses mecanismos é delicada, já que esses serviços armazenam estados e não podem estar sujeitos a perdas, o que incorre em mais um custo de implementá-los e operá-los.

Além disso, a configuração de clusters para escalar aplicações SOA ou microsserviços é extremamente complexa. Quando se trata de uma aplicação monolítica, tudo o que você precisa fazer é hospedar o código em uma máquina virtual e designar mais ou menos recursos computacionais conforme necessário. No caso de microsserviços, cada serviço pode ser implantado independentemente, o que é uma vantagem, mas implantá-los na forma de um cluster em uma rede e fazê-los comunicarem-se entre si, além de escalar automaticamente cada conjunto de recursos, requer grande esforço. Kubernetes oferecem uma solução para isso, mas integrar sua aplicação ao ecossistema significa criar mais uma relação de dependência.

Por fim, é importante ressaltar que o meu objetivo não é condenar a arquitetura orientada a serviços, mas contribuir para que o leitor compreenda melhor a complexidade envolvida no processo de decisão arquitetural. Apesar das desvantagens mencionadas e dos custos associados a elas, a SOA e a arquitetura de microsserviços ainda podem ser mais econômicas do que optar pela monolítica e custear o retrabalho de redesenhar o software caso eventualmente se faça necessário.
